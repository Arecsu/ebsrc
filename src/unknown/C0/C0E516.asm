
UNKNOWN_C0E516:
	BEGIN_C_FUNCTION_FAR
	STACK_RESERVE_VARS
	STACK_RESERVE_INT16
	STACK_RESERVE_INT16
	STACK_RESERVE_INT32
	STACK_RESERVE_INT16
	END_STACK_VARS
	LDA #1
	STA GAME_STATE + game_state::unknown90
	JSR UNKNOWN_C0E44D
	LDX UNKNOWN_7E9F63
	LDA UNKNOWN_7E9F61
	JSL UNKNOWN_C41FFF
	MOVE_INT @VIRTUAL06, @LOCAL02
	AND #$FF00
	XBA
	BPL @UNKNOWN0
	ORA #$FF00
@UNKNOWN0:
	CLC
	ADC UNKNOWN_7E9F67
	TAX
	STX UNKNOWN_7E9F51 + 2
	LDA @LOCAL02
	AND #$FF00
	XBA
	BPL @UNKNOWN1
	ORA #$FF00
@UNKNOWN1:
	CLC
	ADC UNKNOWN_7E9F69
	STA @LOCAL03
	STA UNKNOWN_7E9F55 + 2
	LDA TELEPORT_STYLE
	CMP #TELEPORT_STYLE::PSI_BETTER
	BEQ @UNKNOWN4
	LDA @LOCAL03
	STA @LOCAL00
	LDA GAME_STATE+game_state::leader_direction
	STA @LOCAL01
	TXY
	LDX GAME_STATE+game_state::leader_y_coord
	LDA GAME_STATE+game_state::leader_x_coord
	JSR UNKNOWN_C0DED9
	AND #$00C0
	BEQ @UNKNOWN2
	LDA #2
	STA UNKNOWN_7E9F43
@UNKNOWN2:
	LDA BATTLE_SWIRL_COUNTDOWN
	BEQ @UNKNOWN3
	LDA #2
	STA UNKNOWN_7E9F43
	LDA #1
	STA BATTLE_DEBUG
@UNKNOWN3:
	LDY GAME_STATE+game_state::current_party_members
	LDX UNKNOWN_7E9F55 + 2
	LDA UNKNOWN_7E9F51 + 2
	JSL NPC_COLLISION_CHECK
	CMP #.LOWORD(-1)
	BEQ @UNKNOWN4
	LDA #2
	STA UNKNOWN_7E9F43
@UNKNOWN4:
	LDA UNKNOWN_7E9F43
	CMP #2
	BEQ @UNKNOWN5
	LDA UNKNOWN_7E9F51 + 2
	STA GAME_STATE+game_state::leader_x_coord
	LDA UNKNOWN_7E9F55 + 2
	STA GAME_STATE+game_state::leader_y_coord
@UNKNOWN5:
	SEP #PROC_FLAGS::INDEX8
	LDY #13
	LDA UNKNOWN_7E9F61
	JSL ASR8_UNKNOWN1
	INC
	INC
	AND #$0007
	STA GAME_STATE+game_state::leader_direction
	REP #PROC_FLAGS::INDEX8
	LDY #.LOWORD(UNKNOWN_7E9F45)
	MOVE_INT_YPTRSRC __BSS_START__, @VIRTUAL06
	CLC
	LDA @VIRTUAL06 + fixed_point::fraction
	ADC #$1851 ;approx +0.95
	STA @VIRTUAL06 + fixed_point::fraction
	BCC @UNKNOWN6
	INC @VIRTUAL06 + fixed_point::integer
@UNKNOWN6:
	MOVE_INT_YPTRDEST @VIRTUAL06, __BSS_START__
	LDA TELEPORT_STYLE
	CMP #TELEPORT_STYLE::PSI_BETA
	BNE @UNKNOWN7
	LDA UNKNOWN_7E9F61
	CLC
	ADC #$0A00
	STA UNKNOWN_7E9F61
	LDA UNKNOWN_7E9F63
	CLC
	ADC #12
	STA UNKNOWN_7E9F63
	BRA @UNKNOWN8
@UNKNOWN7:
	LDA UNKNOWN_7E9F65
	CLC
	ADC #32
	STA UNKNOWN_7E9F65
	CLC
	ADC UNKNOWN_7E9F61
	STA UNKNOWN_7E9F61
	LDA UNKNOWN_7E9F63
	CLC
	ADC #16
	STA UNKNOWN_7E9F63
@UNKNOWN8:
	LDX GAME_STATE+game_state::leader_y_coord
	LDA GAME_STATE+game_state::leader_x_coord
	JSL CENTER_SCREEN
	JSR UNKNOWN_C0E196
	JSR UNKNOWN_C0E254
	LDA TELEPORT_STYLE
	CMP #TELEPORT_STYLE::PSI_BETA
	BNE @UNKNOWN9
	LDA UNKNOWN_7E9F63
	CMP #$1000
	BLTEQ @UNKNOWN10
	LDA #1
	STA UNKNOWN_7E9F43
	JSR UNKNOWN_C0E48A
	BRA @UNKNOWN10
@UNKNOWN9:
	LDA UNKNOWN_7E9F65
	CMP #$1800
	BLTEQ @UNKNOWN10
	LDA #1
	STA UNKNOWN_7E9F43
	JSR UNKNOWN_C0E48A
@UNKNOWN10:
	END_C_FUNCTION
